(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4b58"],{CidH:function(t,a,e){"use strict";var l=e("d/mx");e.n(l).a},U7nq:function(t,a,e){"use strict";e.d(a,"a",function(){return i}),e.d(a,"b",function(){return c});var l=e("t3Un"),r="http://www.bivrost.cn/datatable?method=",n="http://www.bivrost.cn/plot?method=";function i(t){return Object(l.a)({url:r+"getStats",method:"post",params:t})}function c(t,a){return Object(l.a)({url:n+t,method:"post",data:a})}},Zc4Q:function(t,a,e){"use strict";e.r(a);var l=e("U7nq"),r={name:"Statistics",components:{IEcharts:e("zkRF").a},filters:{dateFilter:function(t){return t.toLocaleString()}},data:function(){return{testData:"",showBarChart:!1,chartData:[],data_list:[],query:{date:[new Date(2018,6,13),new Date(2018,6,30)],machine:1,type:"pace"},date_shortcut:{shortcuts:[{text:"最近一周",onClick:function(t){var a=new Date,e=new Date;e.setTime(e.getTime()-6048e5),t.$emit("pick",[e,a])}},{text:"最近一个月",onClick:function(t){var a=new Date,e=new Date;e.setTime(e.getTime()-2592e6),t.$emit("pick",[e,a])}},{text:"最近三个月",onClick:function(t){var a=new Date,e=new Date;e.setTime(e.getTime()-7776e6),t.$emit("pick",[e,a])}}]},machine_list:[{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"}],type_list:[{value:"cycle",label:"cycle"},{value:"pace",label:"pace"}],bar_chart_option:{title:{text:""},tooltip:{},xAxis:{data:["最小值","25%分位数","中位数","75%分位数","最大值","平均值","标准差"]},yAxis:{},series:[]}}},computed:{is_add_available:function(){return!(this.query.date[0]&&this.query.date[1]&&this.query.machine&&this.query.type)}},watch:{data_list:function(t){this.chartData=[];for(var a=0;a<this.data_list.length;a++)this.chartData.push(a)},chartData:function(t){this.bar_chart_option.series=[]}},created:function(){},methods:{add_data:function(){var t=this,a={start:t.query.date[0].toLocaleString("zh-CN",{hour12:!1}).replace(/\//g,"-").replace("上午","").replace("下午","").substring(0,19),end:t.query.date[1].toLocaleString("zh-CN",{hour12:!1}).replace(/\//g,"-").replace("上午","").replace("下午",""),machine:t.query.machine,type:t.query.type};Object(l.a)(a).then(function(a){var e={type:t.query.type,date:t.query.date,machine:t.query.machine,sum:a.data.data.count,average:a.data.data.mean,mid:a.data.data["50%"],_1to4:a.data.data["25%"],_3to4:a.data.data["75%"],standard:a.data.data.std,max:a.data.data.max,min:a.data.data.min};t.data_list.push(e),t.query.type=3===Number(t.query.machine)?"pace"===t.query.type?"cycle":"pace":t.query.type,t.query.machine=3!==Number(t.query.machine)?t.query.machine+1:1}).catch(function(t){console.log(t)})},click2ShowChart:function(){this.showBarChart=!0,this.refreshChart()},refreshChart:function(){var t=this;t.bar_chart_option={title:{text:""},tooltip:{},xAxis:{data:["最小值","25%分位数","中位数","75%分位数","最大值","平均值","标准差"]},yAxis:{},series:[]},t.chartData.forEach(function(a,e,l){t.bar_chart_option.series.push({name:"#"+(a+1)+"("+t.data_list[a].machine+"机台@"+t.data_list[a].type+")",type:"bar",data:[t.data_list[a].min,t.data_list[a]._1to4,t.data_list[a].mid,t.data_list[a]._3to4,t.data_list[a].max,t.data_list[a].average,t.data_list[a].standard]})})},chartOnReady:function(t,a){},chartOnClick:function(t,a,e){}}},n=(e("CidH"),e("KHd+")),i=Object(n.a)(r,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"statistics"}},[e("el-container",[e("el-header",[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:1}},[e("el-button",{attrs:{disabled:t.data_list.length<=2,type:"primary",icon:"el-icon-date",circle:""},on:{click:t.click2ShowChart}})],1),t._v(" "),e("el-col",{staticClass:"date-pick",attrs:{span:11}},[e("el-date-picker",{attrs:{"picker-options":t.date_shortcut,type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:t.query.date,callback:function(a){t.$set(t.query,"date",a)},expression:"query.date"}})],1),t._v(" "),e("el-col",{attrs:{span:5}},[e("el-select",{attrs:{placeholder:"机台"},model:{value:t.query.machine,callback:function(a){t.$set(t.query,"machine",a)},expression:"query.machine"}},t._l(t.machine_list,function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),e("el-col",{attrs:{span:5}},[e("el-select",{attrs:{placeholder:"类型"},model:{value:t.query.type,callback:function(a){t.$set(t.query,"type",a)},expression:"query.type"}},t._l(t.type_list,function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),e("el-col",{attrs:{span:2}},[e("el-button",{attrs:{disabled:t.is_add_available,type:"primary",icon:"el-icon-plus",circle:""},on:{click:t.add_data}})],1)],1)],1),t._v(" "),e("el-main",[e("el-table",{attrs:{data:t.data_list}},[e("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-form",{staticClass:"table-expand",attrs:{"label-position":"left",inline:""}},[e("el-form-item",{attrs:{label:"开始时间"}},[e("span",[t._v(t._s(t._f("dateFilter")(a.row.date[0])))])]),t._v(" "),e("el-form-item",{attrs:{label:"结束时间"}},[e("span",[t._v(t._s(t._f("dateFilter")(a.row.date[1])))])]),t._v(" "),e("el-form-item",{attrs:{label:"类型"}},[e("span",[t._v(t._s(a.row.type))])])],1)]}}])}),t._v(" "),e("el-table-column",{attrs:{type:"index"}}),t._v(" "),e("el-table-column",{attrs:{label:"机台",prop:"machine"}}),t._v(" "),e("el-table-column",{attrs:{label:"总数",prop:"sum"}}),t._v(" "),e("el-table-column",{attrs:{label:"平均值",prop:"average"}}),t._v(" "),e("el-table-column",{attrs:{label:"中位数",prop:"mid"}}),t._v(" "),e("el-table-column",{attrs:{label:"25%分位",prop:"_1to4"}}),t._v(" "),e("el-table-column",{attrs:{label:"75%分位",prop:"_3to4"}}),t._v(" "),e("el-table-column",{attrs:{label:"标准差",prop:"standard"}}),t._v(" "),e("el-table-column",{attrs:{label:"最大值",prop:"max"}}),t._v(" "),e("el-table-column",{attrs:{label:"最小值",prop:"min"}}),t._v(" "),e("el-table-column",{attrs:{fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"danger",icon:"el-icon-minus",circle:"",size:"mini"},nativeOn:{click:function(e){e.preventDefault(),t.data_list.splice(a.$index,1)}}})]}}])})],1)],1)],1),t._v(" "),e("el-dialog",{attrs:{visible:t.showBarChart,title:"数据对比",center:""},on:{"update:visible":function(a){t.showBarChart=a}}},[e("div",{staticClass:"bar_chart"},[e("el-checkbox-group",{attrs:{min:2},model:{value:t.chartData,callback:function(a){t.chartData=a},expression:"chartData"}},t._l(t.data_list,function(a,l){return e("el-checkbox",{key:l,attrs:{label:l}},[t._v(t._s("#"+(l+1)+"("+a.machine+"机台@"+a.type+")")+"\n        ")])})),t._v(" "),e("IEcharts",{attrs:{option:t.bar_chart_option},on:{ready:t.chartOnReady,click:t.chartOnClick}})],1)])],1)},[],!1,null,null,null);i.options.__file="statistics.vue";a.default=i.exports},"d/mx":function(t,a,e){}}]);