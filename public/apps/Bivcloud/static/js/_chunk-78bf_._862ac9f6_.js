(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-78bf"],{"0n/l":function(t,e,a){"use strict";a.r(e);var i=a("Wans").a,l=(a("RNcG"),a("KHd+")),n=Object(l.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-tabs",{attrs:{id:"efficiency"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"分段计算",name:"effiFirst"}},[a("el-container",[a("el-header",{staticClass:"contain-header"},[a("el-card",{staticClass:"box-card"},[a("el-button",{staticClass:"head-add-btn",attrs:{type:"primary"},on:{click:function(e){t.addSelectClick()}}},[t._v("新增查询")]),t._l(t.headDataEffi,function(e){return void 0!=e?a("el-row",{key:e.id,staticClass:"head-row",attrs:{name:e.id}},[a("el-col",{staticClass:"head-label",attrs:{span:.5}},[t._v(t._s(e.id)+" | ")]),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:t.ifScreenUnXl,expression:"ifScreenUnXl"}],staticClass:"head-label",attrs:{span:1.5}},[t._v("选择机器：")]),t._v(" "),a("el-col",{attrs:{sm:4,xl:3}},[a("el-select",{attrs:{placeholder:"请选择机器"},on:{change:function(e){t.forceChange()}},model:{value:e.machine,callback:function(a){t.$set(e,"machine",a)},expression:"event.machine"}},t._l(t.machine_list,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:t.ifScreenUnXl,expression:"ifScreenUnXl"}],staticClass:"head-label",attrs:{span:1.5,"hidden-lg-and-down":""}},[t._v("选择日期：")]),t._v(" "),a("el-col",{attrs:{sm:5,xl:4}},[a("el-date-picker",{attrs:{type:"date",multiple:"","value-format":"yyyy-MM-dd",placeholder:"选择日期"},on:{input:function(e){t.forceChange()}},model:{value:e.start_date,callback:function(a){t.$set(e,"start_date",a)},expression:"event.start_date"}})],1),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:t.ifScreenUnXl,expression:"ifScreenUnXl"}],staticClass:"head-label",attrs:{span:1.5}},[t._v("选择时间：")]),t._v(" "),a("el-col",{attrs:{sm:8,xl:6}},[a("el-time-picker",{attrs:{"is-range":"","range-separator":"—","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"HH:mm","value-format":"HH:mm",placeholder:"选择时间范围"},on:{input:function(e){t.forceChange()}},model:{value:e.intervals,callback:function(a){t.$set(e,"intervals",a)},expression:"event.intervals"}})],1),a("el-col",{attrs:{sm:2,xl:3}},[a("el-input",{attrs:{placeholder:"别名"},on:{change:function(e){t.forceChange()}},model:{value:e.alias,callback:function(a){t.$set(e,"alias",a)},expression:"event.alias"}})],1),t._v(" "),a("el-col",{attrs:{span:1.5}},[a("el-button",{staticClass:"head-btn",attrs:{disabled:!(e.intervals&&e.machine&&e.start_date&&t.effiChartUtilData.variables&&t.effiChartUtilData.recipe&&t.effiChartUtilData.days),type:"info",plain:""},on:{click:function(a){t.headConfirmClick(e.id)}}},[t._v("确认")])],1),t._v(" "),a("el-col",{attrs:{span:1.5}},[a("el-button",{staticClass:"head-btn",attrs:{type:"warning",plain:""},on:{click:function(a){t.headClearClick(e.id)}}},[t._v("清除")])],1)],1):t._e()})],2)],1),t._v(" "),a("el-main",[a("div",{staticClass:"main-left",style:t.leftCardStyle},[t.leftCardOpen?a("el-button",{class:t.leftBtnClass.open,attrs:{type:"primary",icon:"el-icon-d-arrow-left",plain:"",circle:""},on:{click:function(e){t.closeLeftCard()}}}):t._e(),t._v(" "),t.leftCardOpen?t._e():a("el-button",{class:t.leftBtnClass.close,attrs:{type:"primary",icon:"el-icon-d-arrow-right",plain:"",circle:""},on:{click:function(e){t.openLeftCard()}}}),t._v(" "),a("el-card",[a("el-tabs",{model:{value:t.effiOptionTabs,callback:function(e){t.effiOptionTabs=e},expression:"effiOptionTabs"}},[a("el-tab-pane",{attrs:{label:"通用配置",name:"utilOption"}},[a("el-form",[a("el-form-item",{attrs:{label:"图表名称"}},[a("el-input",{model:{value:t.effiChartUtilData.title,callback:function(e){t.$set(t.effiChartUtilData,"title",e)},expression:"effiChartUtilData.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"横坐标名称"}},[a("el-input",{model:{value:t.effiChartUtilData.xName,callback:function(e){t.$set(t.effiChartUtilData,"xName",e)},expression:"effiChartUtilData.xName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"纵坐标名称"}},[a("el-input",{model:{value:t.effiChartUtilData.yName,callback:function(e){t.$set(t.effiChartUtilData,"yName",e)},expression:"effiChartUtilData.yName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"合并显示"}},[a("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:t.effiMergeChange},model:{value:t.merge.show,callback:function(e){t.$set(t.merge,"show",e)},expression:"merge.show"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"计算变量"}},[a("el-input",{model:{value:t.effiChartUtilData.variables,callback:function(e){t.$set(t.effiChartUtilData,"variables",e)},expression:"effiChartUtilData.variables"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"计算表达式"}},[a("el-input",{model:{value:t.effiChartUtilData.recipe,callback:function(e){t.$set(t.effiChartUtilData,"recipe",e)},expression:"effiChartUtilData.recipe"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"计算周期"}},[a("el-input",{on:{change:t.forceChange},model:{value:t.effiChartUtilData.days,callback:function(e){t.$set(t.effiChartUtilData,"days",e)},expression:"effiChartUtilData.days"}},[a("template",{slot:"append"},[t._v("天")])],2)],1)],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:"历史参数",name:"historyOption"}},[a("el-table",{attrs:{data:t.effiHistoryData}},[a("el-table-column",{attrs:{prop:"data",label:"参数内容"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{content:e.row.data,placement:"top-start",title:"参数",trigger:"hover"}},[a("p",{staticStyle:{height:"36px"},attrs:{slot:"reference"},on:{click:function(a){t.effiHistoryClick(e)}},slot:"reference"},[t._v(t._s(e.row.data))])])]}}])})],1)],1)],1)],1)],1),a("div",{staticClass:"main-main"},[a("IEcharts",{key:"effiChart",ref:"ieCharts",attrs:{option:t.effiChartOption},on:{click:t.effiClick}})],1)])],1)],1),t._v(" "),a("el-tab-pane",{attrs:{lazy:!0,label:"整体绘制",name:"effiSecond"}},[a("el-container",[a("el-header",{staticClass:"contain-header"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"head-right-control"},[a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.addSelectClick()}}},[t._v("新增查询")])],1),t._v(" "),a("el-row")],1),t._v(" "),t._l(t.headDataAll,function(e){return void 0!=e?a("el-row",{key:e.id,staticClass:"head-row",attrs:{name:e.id}},[a("el-col",{staticClass:"head-label",attrs:{span:.5}},[t._v(t._s(e.id)+" | ")]),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:t.ifScreenUnXl,expression:"ifScreenUnXl"}],staticClass:"head-label",attrs:{span:1.5}},[t._v("选择机器：")]),t._v(" "),a("el-col",{attrs:{sm:4,xl:3}},[a("el-select",{attrs:{placeholder:"请选择机器"},on:{change:function(e){t.forceChange()}},model:{value:e.machine,callback:function(a){t.$set(e,"machine",a)},expression:"event.machine"}},t._l(t.machine_list,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:t.ifScreenUnXl,expression:"ifScreenUnXl"}],staticClass:"head-label",attrs:{span:1.5}},[t._v("选择时间：")]),t._v(" "),a("el-col",{attrs:{sm:8,xl:6}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{"picker-options":t.date_shortcut,"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetimerange","range-separator":"至","start-placeholder":"开始","end-placeholder":"结束",align:"right"},model:{value:e.interval,callback:function(a){t.$set(e,"interval",a)},expression:"event.interval"}})],1),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:t.ifScreenUnXl,expression:"ifScreenUnXl"}],staticClass:"head-label",attrs:{span:1.5}},[t._v("最小值：")]),t._v(" "),a("el-col",{attrs:{sm:2,xl:3}},[a("el-input",{attrs:{placeholder:"最小值"},on:{change:function(e){t.forceChange()}},model:{value:e.min,callback:function(a){t.$set(e,"min",a)},expression:"event.min"}})],1),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:t.ifScreenUnXl,expression:"ifScreenUnXl"}],staticClass:"head-label",attrs:{span:1.5}},[t._v("最大值：")]),t._v(" "),a("el-col",{attrs:{sm:2,xl:3}},[a("el-input",{attrs:{placeholder:"最大值"},on:{change:function(e){t.forceChange()}},model:{value:e.max,callback:function(a){t.$set(e,"max",a)},expression:"event.max"}})],1),t._v(" "),a("el-col",{attrs:{span:1.5}},[a("el-button",{staticClass:"head-btn",attrs:{disabled:!e.machine||!t.allChartUtilData.type,type:"info",plain:""},on:{click:function(a){t.headConfirmClick(e.id)}}},[t._v("确认")])],1),t._v(" "),a("el-col",{attrs:{span:1.5}},[a("el-button",{staticClass:"head-btn",attrs:{type:"warning",plain:""},on:{click:function(a){t.headClearClick(e.id)}}},[t._v("清除")])],1)],1):t._e()})],2)],1),t._v(" "),a("el-main",[a("div",{staticClass:"main-left",style:t.leftCardStyle},[t.leftCardOpen?t._e():a("el-button",{class:t.leftBtnClass.close,attrs:{type:"primary",icon:"el-icon-d-arrow-right",plain:"",circle:""},on:{click:function(e){t.openLeftCard()}}}),t._v(" "),t.leftCardOpen?a("el-button",{class:t.leftBtnClass.open,attrs:{type:"primary",icon:"el-icon-d-arrow-left",plain:"",circle:""},on:{click:function(e){t.closeLeftCard()}}}):t._e(),t._v(" "),a("el-card",[a("el-tabs",{model:{value:t.allOptionTabs,callback:function(e){t.allOptionTabs=e},expression:"allOptionTabs"}},[a("el-tab-pane",{attrs:{label:"通用配置",name:"utilOption"}},[a("el-form",[a("el-form-item",{attrs:{label:"图表名称"}},[a("el-input",{model:{value:t.allChartUtilData.title,callback:function(e){t.$set(t.allChartUtilData,"title",e)},expression:"allChartUtilData.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"横坐标名称"}},[a("el-input",{model:{value:t.allChartUtilData.xName,callback:function(e){t.$set(t.allChartUtilData,"xName",e)},expression:"allChartUtilData.xName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"纵坐标名称"}},[a("el-input",{model:{value:t.allChartUtilData.yName,callback:function(e){t.$set(t.allChartUtilData,"yName",e)},expression:"allChartUtilData.yName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"选择类型"}},[a("el-select",{model:{value:t.allChartUtilData.type,callback:function(e){t.$set(t.allChartUtilData,"type",e)},expression:"allChartUtilData.type"}},[a("el-option",{attrs:{value:"pace",label:"节拍时间"}}),a("el-option",{attrs:{value:"cycle",label:"程序时间"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"显示直方图"}},[a("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:t.histChange},model:{value:t.hist.show,callback:function(e){t.$set(t.hist,"show",e)},expression:"hist.show"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"直方图区间数量"}},[a("el-input",{on:{change:t.histChange},model:{value:t.hist.num,callback:function(e){t.$set(t.hist,"num",e)},expression:"hist.num"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"直方图区间值"}},[a("el-input",{on:{change:t.histChange},model:{value:t.hist.value,callback:function(e){t.$set(t.hist,"value",e)},expression:"hist.value"}})],1)],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:"历史参数",name:"historyOption"}},[a("el-table",{attrs:{data:t.allHistoryData}},[a("el-table-column",{attrs:{prop:"data",label:"参数内容"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{content:e.row.data,placement:"top-start",title:"参数",trigger:"hover"}},[a("p",{staticStyle:{height:"36px"},attrs:{slot:"reference"},on:{click:function(a){t.allHistoryClick(e)}},slot:"reference"},[t._v(t._s(e.row.data))])])]}}])})],1)],1)],1)],1)],1),a("div",{staticClass:"main-main"},[a("IEcharts",{key:"allChart",staticStyle:{width:"100%",height:"100%"},attrs:{"auto-resize":!0,option:t.allChartOption}}),a("el-table",{staticStyle:{"margin-left":"10px"},attrs:{data:t.histTableData,border:""}},[a("el-table-column",{attrs:{prop:"ID",label:"序号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"min",label:"最小值"}}),t._v(" "),a("el-table-column",{attrs:{prop:"max",label:"最大值"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mean",label:"平均值"}}),t._v(" "),a("el-table-column",{attrs:{prop:"25%",label:"25%"}}),t._v(" "),a("el-table-column",{attrs:{prop:"75%",label:"75%"}}),t._v(" "),a("el-table-column",{attrs:{prop:"cpk",label:"CPK"}}),t._v(" "),a("el-table-column",{attrs:{prop:"stddev",label:"标准差"}})],1)],1)])],1)],1)],1)},[],!1,null,"ccaef0f0",null);n.options.__file="efficiency.vue";e.default=n.exports},"7D/Q":function(t,e,a){},RNcG:function(t,e,a){"use strict";var i=a("7D/Q");a.n(i).a},U7nq:function(t,e,a){"use strict";a.d(e,"b",function(){return h}),a.d(e,"e",function(){return _}),a.d(e,"d",function(){return u}),a.d(e,"f",function(){return p}),a.d(e,"c",function(){return m}),a.d(e,"g",function(){return v}),a.d(e,"a",function(){return b});var i=a("t3Un"),l="/datatable",n="/plot",s="/production/plan",r="http://www.bivrost.cn",o="/production/product",c="/production/group",d="/user",f="/chartdata";function h(t){return Object(i.a)({url:r+l,method:"get",params:t})}function _(t,e){return Object(i.a)({url:r+n,method:"post",data:e})}function u(t){return Object(i.a)({url:r+s,method:"post",data:t})}function p(t){return Object(i.a)({url:r+o,method:"post",data:t})}function m(t){return Object(i.a)({url:r+c,method:"post",data:t})}function v(t){return Object(i.a)({url:r+d,method:"post",data:t})}function b(t){return Object(i.a)({url:r+f,method:"post",data:t})}},Wans:function(module,__webpack_exports__,__webpack_require__){"use strict";var babel_runtime_core_js_json_stringify__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("gDS+"),babel_runtime_core_js_json_stringify__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(babel_runtime_core_js_json_stringify__WEBPACK_IMPORTED_MODULE_0__),_api__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("U7nq"),vue_echarts_v3_src_full_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("zkRF"),element_ui_lib_theme_chalk_display_css__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("4F9Q"),element_ui_lib_theme_chalk_display_css__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(element_ui_lib_theme_chalk_display_css__WEBPACK_IMPORTED_MODULE_3__);__webpack_exports__.a={name:"Efficiency",components:{IEcharts:vue_echarts_v3_src_full_js__WEBPACK_IMPORTED_MODULE_2__.a},data:function(){return{activeName:"effiFirst",effiOptionTabs:"utilOption",allOptionTabs:"utilOption",historyOptionData:[],effiHistoryOptionData:[],allHistoryOptionData:[],effiChartUtilData:{title:"图表",xName:"日期",yName:"数值",variables:"throughput,elasped,setup,poweroff",recipe:"3600*throughput/(elasped-setup-poweroff)",days:"7"},allChartUtilData:{title:"图表",xName:"次数",yName:"数值",type:"pace"},leftCardStyle:{width:"20%"},leftCardOpen:!0,leftBtnClass:{open:"left-card-switch-open",close:"left-card-switch-close"},topCardOpen:!0,topBtnClass:{open:"top-card-switch-open",close:"top-card-switch-close"},selectID:2,headDataEffi:[{id:"0",machine:"1",start_date:"2018-07-18",intervals:["12:00","18:00"],alias:""}],headDataAll:[void 0,{id:"1",machine:"1",interval:["2018-07-16 13:30:00","2018-07-16 17:30:00"],min:"0",max:"900"}],dataModel:{id:"",machine:"1",start_date:"2018-07-18",intervals:["12:00","18:00"],alias:""},dataModelAll:{id:"",machine:"1",interval:["2018-07-16 13:30:00","2018-07-16 17:30:00"],min:"0",max:"900"},effiResultData:[],allResultData:[],queryList:[],hist:{show:!1,num:30,value:30,xName:"区间",yName:"频次"},merge:{show:!1},queryModel:{machine:"",start_date:"",intervals:"",days:0,variables:"",recipe:""},machine_list:[{value:"1",label:"1号机台"},{value:"2",label:"2号机台"},{value:"3",label:"3号机台"},{value:"4",label:"4号机台"}],screenWidth:document.body.clientWidth,effiChartOption:{},allChartOption:{},histTableData:[],date_shortcut:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]}}},computed:{ifScreenUnXl:function(){return this.screenWidth>1900},effiHistoryData:function(){return this.effiHistoryOptionData.map(function(t){return{data:t.data}})},allHistoryData:function(){return this.allHistoryOptionData.map(function(t){return{data:t.data}})}},beforeMount:function(){this.getChartData("effiFirst"),this.getChartData("effiAll")},mounted:function(){var t=this;window.onresize=function(){return window.screenWidth=document.body.clientWidth,void(t.screenWidth=window.screenWidth)}},methods:{forceChange:function(){this.$forceUpdate()},headClearClick:function(t){if("effiFirst"===this.activeName){if(2===this.headDataEffi.toString().split("[object").length)return;this.headDataEffi[t]=void 0,this.effiResultData[t]=void 0}else{if(2===this.headDataAll.toString().split("[object").length)return;this.headDataAll[t]=void 0,this.allResultData[t]=void 0}this.makeChart(),this.$forceUpdate()},headConfirmClick:function(t){var e=void 0,a=void 0;if("effiFirst"===this.activeName){e="effiFirst";var i=this.headDataEffi[t],l={method:"any",query:{machine:i.machine,start_date:i.start_date,days:this.effiChartUtilData.days,variables:this.effiChartUtilData.variables,recipe:this.effiChartUtilData.recipe,intervals:i.intervals[0]+":00-"+i.intervals[1]+":00"}};this.getEffiData(l,t),l.query.alias=i.alias,a=babel_runtime_core_js_json_stringify__WEBPACK_IMPORTED_MODULE_0___default()(l.query)}else{e="effiAll";var n=this.headDataAll[t],s={method:"getdata",query:{machine:n.machine,min:parseInt(n.min),max:parseInt(n.max),start:n.interval[0],end:n.interval[1],type:this.allChartUtilData.type}};a=babel_runtime_core_js_json_stringify__WEBPACK_IMPORTED_MODULE_0___default()(s.query),this.getEffiData(s,t)}this.setChartData({key:e,params:a})},addSelectClick:function(){if("effiFirst"===this.activeName){this.dataModel.id=this.selectID;var t=JSON.parse(babel_runtime_core_js_json_stringify__WEBPACK_IMPORTED_MODULE_0___default()(this.dataModel));this.headDataEffi[this.dataModel.id]=t}else{this.dataModelAll.id=this.selectID;var e=JSON.parse(babel_runtime_core_js_json_stringify__WEBPACK_IMPORTED_MODULE_0___default()(this.dataModelAll));this.headDataAll[this.dataModelAll.id]=e}this.selectID++,this.$forceUpdate()},getEffiData:function(t,e){var a=this;Object(_api__WEBPACK_IMPORTED_MODULE_1__.e)("any",t).then(function(t){"effiFirst"===a.activeName?a.effiResultData[e]=t.data.data:a.allResultData[e]=t.data.data,a.loading=!1,a.$message({message:"数据加载成功!",type:"success"}),a.makeChart()}).catch(function(t){console.log(t),a.$message({message:"request failed",type:"error"}),a.laoding=!1})},makeChart:function(){var t=this,e=[],a=void 0,i={data:[]},l={type:"category",data:[],boundaryGap:!0,axisLabel:{rotate:45}},n={};if("effiFirst"===this.activeName){a=this.effiChartUtilData;var s=this.effiResultData,r=this.headDataEffi;if(this.merge.show){var o={name:"",type:"line",data:[]};for(var c in s)for(var d in s[c]){var f=r[c].alias?d+" | "+r[c].alias:d+" | "+r[c].id;l.data.push(f),l.data.sort(function(t,e){var a=t.split(" | ")[0],i=e.split(" | ")[0];return a===i?t.split(" | ")[1]>e.split(" | ")[1]:new Date(a)-new Date(i)}),o.data[l.data.indexOf(f)]=s[c][d]}e.push(o)}else{for(var h in s){var _={name:"",type:"line",connectNulls:!0,data:[]};for(var u in s[h])-1===l.data.indexOf(u)&&l.data.push(u),_.data.push([u,s[h][u]]);if(void 0!==s[h]){var p=this.headDataEffi[h].alias?this.headDataEffi[h].alias:h.toString();i.data.push(p),_.name=p,_.id=h}e.push(_)}l.data.sort()}}else{a=this.allChartUtilData;var m=this.allResultData;if(this.hist.show){for(var v=[],b=0;b<this.hist.num;b++)v.push(0),l.data.push(b*this.hist.value+"～"+(b+1)*this.hist.value);for(var C in m){var D=v.slice(),y={name:"",type:"bar",barWidth:"100%",stack:"hist",data:[],label:{normal:{show:!0,position:"top"}}};for(var g in m[C])D[Math.floor(m[C][g]/this.hist.value)]++;for(var O in y.name=C.toString(),void 0!==m[C]&&i.data.push(C.toString()),D)0===D[O]&&(D[O]=void 0);y.data=D,e.push(y)}}else for(var k in m){var w=1,x={name:"",type:"line",connectNulls:!0,data:[]};for(var U in m[k])-1===l.data.indexOf(w)&&l.data.push(w),x.data.push(m[k][U]),w++;x.name=k.toString(),void 0!==m[k]&&i.data.push(k.toString()),e.push(x)}this.histTableData=[];var E=[];for(var M in m){var S={name:"",data:[]};for(var N in m[M])S.data.push(m[M][N]);S.name=M.toString(),E.push(S)}for(var A in E)E[A].data.length>0&&function(){var e=JSON.parse(babel_runtime_core_js_json_stringify__WEBPACK_IMPORTED_MODULE_0___default()(E[A].data)),a=function(t,e){return t+e},i=e.reduce(a)/e.length,l=e.map(function(t){return t-i}),n=Math.sqrt(l.map(function(t){return t*t}).reduce(a)/(e.length-1)),s=Math.max.apply(null,e),r=Math.min.apply(null,e);e.sort(function(t,e){return t<e?-1:t>e?1:0}),e.length%2==0&&(e[e.length/2],e[e.length/2+1]),e.length%2!=0&&e[(e.length+1)/2];var o=function(t,e){var a=((t=t.sort()).length-1)*e,i=Math.floor(a),l=a-i;return void 0!==t[i+1]?t[i]+l*(t[i+1]-t[i]):t[i]},c=o(e,.25),d=o(e,.75);t.histTableData.push({ID:E[A].name,min:r,max:s,mean:i.toPrecision(6),"25%":c,"75%":d,stddev:n.toPrecision(6),cpk:Math.min((s-i)/(3*n),(i-r)/(3*n)).toPrecision(6)})}()}l.name=a.xName,n.name=a.yName;var P={title:{text:a.title||"Chart"},tooltip:{},xAxis:l,yAxis:n,grid:{bottom:100},series:e,legend:i,dataZoom:[{type:"slider",xAxisIndex:0},{type:"slider",yAxisIndex:0,filterMode:"empty"},{type:"inside",xAxisIndex:0,filterMode:"empty"}],toolbox:{feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}}}};"effiFirst"===this.activeName?this.effiChartOption=P:this.allChartOption=P,this.$forceUpdate(),console.log(this),console.log(this.effiChartOption)},effiClick:function(t,e,a){this.activeName="effiSecond",this.dataModelAll.id=this.selectID;var i=this.headDataEffi[t.seriesId],l=JSON.parse(babel_runtime_core_js_json_stringify__WEBPACK_IMPORTED_MODULE_0___default()(this.dataModelAll));l.interval[0]=i.start_date+" "+i.intervals[0]+":00",l.interval[1]=i.start_date+" "+i.intervals[1]+":00",l.machine=i.machine,this.headDataAll[this.dataModelAll.id]=l,this.$forceUpdate(),this.headConfirmClick(this.dataModelAll.id),this.selectID++},getChartData:function(t){var e=this;Object(_api__WEBPACK_IMPORTED_MODULE_1__.a)({method:"read",query:{page:1,limit:10,key_name:[t],order:["updated_at","DESC"]}}).then(function(a){"effiFirst"===t?e.effiHistoryOptionData=a.data.data.results:e.allHistoryOptionData=a.data.data.results})},setChartData:function(t){var e=this;Object(_api__WEBPACK_IMPORTED_MODULE_1__.a)({method:"create",query:{key_name:t.key,data:t.params}}).then(function(){e.getChartData(t.key)}).catch(function(t){console.log("查询数据上传失败"+t)})},histChange:function(){this.makeChart()},closeLeftCard:function(){this.leftCardStyle.width="1%",this.leftCardOpen=!1},openLeftCard:function(){this.leftCardStyle.width="20%",this.leftCardOpen=!0},effiHistoryClick:function effiHistoryClick(event){var eventObj=eval("("+event.row.data+")");this.dataModel.id=this.selectID;var models=JSON.parse(babel_runtime_core_js_json_stringify__WEBPACK_IMPORTED_MODULE_0___default()(this.dataModel));models.machine=eventObj.machine,models.start_date=eventObj.start_date,models.intervals=eventObj.intervals.split("-"),models.intervals[0]=models.intervals[0].slice(0,5),models.intervals[1]=models.intervals[1].slice(0,5),models.alias=eventObj.alias,this.headDataEffi[this.dataModel.id]=models,this.selectID++,this.$forceUpdate()},allHistoryClick:function(t){var e=JSON.parse(t.row.data);this.dataModelAll.id=this.selectID;var a=JSON.parse(babel_runtime_core_js_json_stringify__WEBPACK_IMPORTED_MODULE_0___default()(this.dataModelAll));a.machine=e.machine,a.min=e.min,a.max=e.max,a.start=e.start,a.end=e.end,this.headDataAll[this.dataModelAll.id]=a,this.selectID++,this.$forceUpdate()},effiMergeChange:function(){this.makeChart()}}}},"gDS+":function(t,e,a){t.exports={default:a("oh+g"),__esModule:!0}},"oh+g":function(t,e,a){var i=a("WEpk"),l=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return l.stringify.apply(l,arguments)}}}]);